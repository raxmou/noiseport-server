
services:
  wizard:
    image: maxenceroux/noiseport-server:latest
    container_name: noiseport-wizard
    user: root
    ports:
      - "8000:8000"
    environment:
      - WIZARD_MODE=true
      - PYTHONPATH=/app
      - WIZARD_CONFIG_DIR=/app/wizard-config
    volumes:
      # Mount dedicated config directory for persistence (not entire project root)
      - ./wizard-config:/app/wizard-config
      - ./wizard-config/.env:/app/.env
      # Mount slskd template directory for reading template
      - ./slskd:/app/slskd:ro
      # Mount docker-compose template for reading
      - ./docker-compose.full.yml.template:/app/docker-compose.full.yml.template:ro
      # Mount Docker socket for ComposeRunner
      - /var/run/docker.sock:/var/run/docker.sock
    command: uvicorn app.main:app --host 0.0.0.0 --port 8000
    restart: unless-stopped


networks:
  default:
    name: noiseport-wizard
    driver: bridge